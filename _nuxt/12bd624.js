(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{239:function(e,t,r){var content=r(251);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(39).default)("03709a62",content,!0,{sourceMap:!1})},250:function(e,t,r){"use strict";r(239)},251:function(e,t,r){(t=r(38)(!1)).push([e.i,".password-strength{display:flex;align-items:center}.password-strength>div:last-child{flex:1 0 0;margin-left:1rem}.password-strength .progress{height:.5rem}",""]),e.exports=t},287:function(e,t,r){"use strict";r.r(t);r(15),r(16),r(10),r(37),r(31);var n=r(8),o=r(13),c=r(53),d=r(19),l=r(20),f=r(9),h=r(7),v=r(33);function w(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(f.a)(e);if(t){var o=Object(f.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(l.a)(this,r)}}var m=function(e,t,r,desc){var n,o=arguments.length,c=o<3?t:null===desc?desc=Object.getOwnPropertyDescriptor(t,r):desc;if("object"===("undefined"==typeof Reflect?"undefined":Object(h.a)(Reflect))&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,r,desc);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(c=(o<3?n(c):o>3?n(t,r,c):n(t,r))||c);return o>3&&c&&Object.defineProperty(t,r,c),c},y=function(e){Object(d.a)(x,e);var t,r,l,f,h,v,m,y,k=w(x);function x(){var e;return Object(o.a)(this,x),(e=k.apply(this,arguments)).oldPassword="",e.newPassword="",e.verificationCode="",e.qrCode="",e.loadingPassword=!1,e.loadingRegenerate=!1,e.loading=!1,e.hasPassword=!0,e.showQrCode=!1,e.backupCodesAll=0,e.backupCodesUsed=0,e.twoFactorEnabled=!1,e}return Object(c.a)(x,[{key:"backupCodesHtml",value:function(e){return'In case you lose access to your authenticator device, you can use these backup codes to login. Make sure you keep them someplace safe. <strong>You won\'t see these backup codes again.</strong><div style="margin-top: 1rem; display: flex; flex-wrap: wrap; justify-content: center">'.concat(e.map((function(i){return'<div style="margin: 0.5rem"><code>'.concat(i,"</code></div>")})).join("\n"),"</div>")}},{key:"created",value:(y=Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.getPassword(),e.abrupt("return",this.get());case 2:case"end":return e.stop()}}),e,this)}))),function(){return y.apply(this,arguments)})},{key:"get",value:(m=Object(n.a)(regeneratorRuntime.mark((function e(){var t,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.$axios.get("/users/".concat(this.$route.params.id,"?select=twoFactorEnabled,backupCodes"));case 4:t=e.sent,data=t.data,this.twoFactorEnabled=data.twoFactorEnabled,this.backupCodesAll=(data.backupCodes||[]).length,this.backupCodesUsed=(data.backupCodes.filter((function(i){return i.isUsed})).length||[]).length,e.next=13;break;case 11:e.prev=11,e.t0=e.catch(1);case 13:this.loading=!1;case 14:case"end":return e.stop()}}),e,this,[[1,11]])}))),function(){return m.apply(this,arguments)})},{key:"getPassword",value:(v=Object(n.a)(regeneratorRuntime.mark((function e(){var t,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.$axios.get("/users/".concat(this.$route.params.id,"/security/password"));case 4:t=e.sent,data=t.data,this.hasPassword=data.hasPassword,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(){return v.apply(this,arguments)})},{key:"save",value:(h=Object(n.a)(regeneratorRuntime.mark((function e(){var t,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loadingPassword=!0,e.prev=1,e.next=4,this.$axios.put("/users/".concat(this.$route.params.id,"/security/password"),{oldPassword:this.oldPassword,newPassword:this.newPassword});case 4:t=e.sent,data=t.data,this.$buefy.toast.open({message:data.text,type:"is-success"}),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:this.oldPassword="",this.newPassword="",this.loadingPassword=!1;case 14:case"end":return e.stop()}}),e,this,[[1,9]])}))),function(){return h.apply(this,arguments)})},{key:"enable",value:(f=Object(n.a)(regeneratorRuntime.mark((function e(){var t,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.$axios.get("/users/".concat(this.$route.params.id,"/security/2fa/enable"));case 4:t=e.sent,data=t.data,this.qrCode=data.qrCode,this.showQrCode=!0,e.next=12;break;case 10:e.prev=10,e.t0=e.catch(1);case 12:this.loading=!1;case 13:case"end":return e.stop()}}),e,this,[[1,10]])}))),function(){return f.apply(this,arguments)})},{key:"verify",value:(l=Object(n.a)(regeneratorRuntime.mark((function e(){var t,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,e.next=4,this.$axios.post("/users/".concat(this.$route.params.id,"/security/2fa/verify"),{code:this.verificationCode});case 4:t=e.sent,data=t.data,this.showQrCode=!1,this.twoFactorEnabled=!0,this.$buefy.dialog.alert({title:"Backup codes",message:this.backupCodesHtml(data.backupCodes),confirmText:"Yes, I've copied them"}),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(1);case 13:this.verificationCode="",this.loading=!1;case 15:case"end":return e.stop()}}),e,this,[[1,11]])}))),function(){return l.apply(this,arguments)})},{key:"regenerate",value:(r=Object(n.a)(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.$buefy.dialog.confirm({title:"Regenerate backup codes",message:"Are you sure you want to regenerate your backup codes? The current codes will stop working immediately.",confirmText:"Yes, regenerate",cancelText:"No, don't regenerate",hasIcon:!0,trapFocus:!0,onConfirm:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){var r,data;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loadingRegenerate=!0,e.prev=1,e.next=4,t.$axios.get("/users/".concat(t.$route.params.id,"/security/backup-codes/regenerate"));case 4:r=e.sent,data=r.data,t.$buefy.dialog.alert({title:"Backup codes",message:t.backupCodesHtml(data.backupCodes),confirmText:"Yes, I've copied them"}),e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:t.loadingRegenerate=!1;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"disable",value:(t=Object(n.a)(regeneratorRuntime.mark((function e(t,r){var o=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.$buefy.dialog.confirm({title:"Disabling 2FA",message:"Are you sure you want to disable two-factor authentication? This will make your account less secure.",confirmText:"Yes, disable 2FA",cancelText:"No, don't disable 2FA",type:"is-danger",hasIcon:!0,trapFocus:!0,onConfirm:function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.loading=!0,e.prev=1,e.next=4,o.$axios.delete("/users/".concat(o.$route.params.id,"/security/2fa"));case 4:e.sent.data,o.twoFactorEnabled=!1,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:o.loading=!1;case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})}]),x}(v.b),k=y=m([Object(v.a)({middleware:"authenticated",layout:"users"})],y),x=(r(250),r(11)),component=Object(x.a)(k,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",{staticClass:"is-size-4 mb-4"},[e._v("Passwords & 2FA")]),e._v(" "),r("h2",{staticClass:"is-size-5 mb-3"},[e._v("Change password")]),e._v(" "),r("form",{on:{submit:function(t){return t.preventDefault(),e.save(t)}}},[e.hasPassword?r("b-field",{attrs:{label:"Current password"}},[r("b-input",{attrs:{type:"password","password-reveal":"",required:""},model:{value:e.oldPassword,callback:function(t){e.oldPassword=t},expression:"oldPassword"}})],1):e._e(),e._v(" "),r("b-field",{attrs:{label:"New password"}},[r("b-input",{attrs:{type:"password","password-reveal":"",required:""},model:{value:e.newPassword,callback:function(t){e.newPassword=t},expression:"newPassword"}})],1),e._v(" "),r("div",{staticClass:"password-strength mt-3 mb-3"},[r("div",[e._v("Password strength")]),e._v(" "),r("b-progress",{attrs:{value:e.newPassword.length/25*100,size:"is-small",type:e.newPassword.length<8?"is-danger":e.newPassword.length<20?"is-warning":"is-success"}})],1),e._v(" "),r("div",[r("b-button",{attrs:{type:"is-primary","native-type":"submit",loading:e.loadingPassword,"icon-left":"key-variant"}},[e._v("Change password")])],1)],1),e._v(" "),r("h2",{staticClass:"is-size-5 mb-3 mt-5"},[e._v("Two-factor authentication")]),e._v(" "),e.twoFactorEnabled?r("div",[r("b-message",{attrs:{type:"is-success","has-icon":""}},[e._v("\n      2FA adds an additional layer of protection in your account. You have 2FA\n      "),r("strong",[e._v("enabled")]),e._v("\n      and have used "+e._s(e.backupCodesUsed)+"/"+e._s(e.backupCodesAll)+"\n      backup codes.\n    ")]),e._v(" "),r("div",{staticClass:"buttons mt-3"},[r("b-button",{attrs:{type:"is-danger",loading:e.loading,"icon-left":"lock-open"},on:{click:e.disable}},[e._v("Disable 2FA")]),e._v(" "),r("b-button",{attrs:{loading:e.loadingRegenerate,"icon-left":"backup-restore"},on:{click:e.regenerate}},[e._v("Regenerate backup codes")])],1)],1):r("div",[r("p",[e._v("\n      2FA adds an additional layer of protection in your account. You'll need\n      to have a TOTP app like Google Authenticator or a password manager like\n      1Password to use 2FA.\n    ")]),e._v(" "),r("div",{staticClass:"buttons mt-3"},[r("b-button",{attrs:{type:"is-success",loading:e.loading,"icon-left":"lock"},on:{click:e.enable}},[e._v("Enable 2FA")])],1)]),e._v(" "),r("b-modal",{attrs:{width:300,active:e.showQrCode},on:{"update:active":function(t){e.showQrCode=t}}},[r("div",{staticClass:"card"},[r("div",{staticClass:"card-content"},[r("p",{staticClass:"image is-square"},[r("img",{attrs:{src:e.qrCode}})]),e._v(" "),r("p",{staticClass:"mt-3"},[e._v("\n          Scan this QR code in your authenticator app and enter the one-time\n          password (OTP).\n        ")]),e._v(" "),r("form",{staticClass:"mt-4",on:{submit:function(t){return t.preventDefault(),e.verify(t)}}},[r("b-field",{attrs:{label:"One-time password"}},[r("b-input",{attrs:{type:"text",inputmode:"numeric",pattern:"[0-9]*",required:""},model:{value:e.verificationCode,callback:function(t){e.verificationCode=t},expression:"verificationCode"}})],1),e._v(" "),r("div",{staticClass:"buttons"},[r("b-button",{attrs:{type:"is-primary","native-type":"submit",loading:e.loading,"icon-left":"lock-open"}},[e._v("Enable 2FA")])],1)],1)])])])],1)}),[],!1,null,null,null);t.default=component.exports}}]);